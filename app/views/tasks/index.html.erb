<%= render "new-button" %>

<div data-controller="task-form" class="d-flex flex-row align-items-center justify-content-center">
   <%= render "today" %>
</div>

<div class="d-flex flex-row flex-wrap justify-content-center pt-1 mt-1 off-white">

   <% @tasks.reverse_each do |task| %>

      <% if task.user == current_user %>

      <div class="bg-light border-0 card m-4 shadow d-flex flex-column justify-content-between" style="width: 18rem; height: auto;">

         <%= link_to task_path(task), class: "text-decoration-none link-dark" do %>
            <div class="card-body d-flex flex-column justify-content-between" style="height: 10rem;">
               <h4 class="card-title border-bottom border-warning pb-1 ubuntu-font text-maroon"><%= task.task_name %></h4>
               
               <h6 class="card-subtitle mb-2 text-muted">Deadline: <%= task.task_deadline ? task.task_deadline.utc.localtime.strftime('%d %b %Y %I:%M %p') : 'None' %> </h6>
               <h6 class="card-subtitle mb-2 text-muted">Done: <%= task.task_done %> </h6>
               <p class="card-text"><%= task.task_details[0, 50]... %></p>
               <small class="card-text text-muted sm">(<%= task.created_at.utc.localtime.strftime('%d %b %Y %I:%M %p') %>)</small>
            </div>
         
         <% end %>
         
         <div class='m-2 d-flex flex-wrap mt-4'> 
            <% task.labels.reverse_each do |l| %>
               <%= link_to label_path(l), class: "text-decoration-none link-dark" do %>
                  <button class="bg-warning p-1 m-1 rounded text-maroon btn-sm border-0"> <%= l.label_name%> </button>
               <%end%>
            <%end%>
         </div>

         <div class="d-flex flex-row justify-content-end m-3">
               <button type="button" class="btn btn-outline-success btn-sm mx-0 border-0"><%= link_to '✏️', edit_task_path(task), class: "text-decoration-none text-white" %></button>
               <button type="button" class="btn btn-outline-danger btn-sm border-0"><%= link_to '❌', task_path(task), method: :delete, data: {confirm: 'Delete chosen blog PERMANENTLY?'}, class: "text-decoration-none text-white" %></button>
         </div>

      </div>

      <% end %>
   <% end %>

</div>
